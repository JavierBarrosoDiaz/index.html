<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Carrito de Compra - Mi Tienda de Suplementos</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <a href="index.html">
  <img src="Naturpower.png" alt="Logo de la tienda" class="logo">
  </a>
  <nav>
    <a href="index.html">Inicio</a>
    <a href="productos.html">Productos</a>
    <a href="sobre-nosotros.html">Sobre Nosotros</a>
    <a href="blog.html">Blog</a>
    <a href="contacto.html">Contacto</a>
  </nav>
</header>

<div class="container">
  <!-- NUEVA LISTA DE DESEOS -->
  <div class="wishlist">
    <h2>Lista de deseos ‚ù§Ô∏è</h2>
    <ul id="lista-deseos">
      <!-- Productos guardados se cargar√°n aqu√≠ con JS -->
    </ul>
  </div>
  <!-- Lista del carrito -->
  <div class="cart-items">
    <h2>Mi Cesta</h2>
    <ul id="lista-carrito">
      <!-- Productos se agregan con JS -->
    </ul>
    <p class="cart-total">Total: ‚Ç¨<span id="total">0</span></p>
    <button onclick="vaciarCarrito()" style="padding:10px; background:red; color:#fff; border:none; border-radius:5px; cursor:pointer;">Vaciar Cesta</button>
  </div>

  <!-- Formulario de checkout -->
  <div class="checkout-form">
    <h2>Datos de env√≠o</h2>
    <form id="form-checkout">
      <input type="text" id="nombre" placeholder="Nombre completo" required>
      <input type="email" id="email" placeholder="Correo electr√≥nico" required>
      <input type="tel" id="telefono" placeholder="Tel√©fono" required>
      <textarea id="direccion" placeholder="Direcci√≥n de env√≠o" rows="4" required></textarea>
      <button type="submit">Finalizar Compra</button>
    </form>
  </div>
</div>

<script>

let carrito = JSON.parse(localStorage.getItem('carrito')) || [];

function actualizarCarrito() {
  const lista = document.getElementById('lista-carrito');
  lista.innerHTML = '';
  let total = 0;
  if(carrito.length === 0){
    lista.innerHTML = '<li>Tu carrito est√° vac√≠o</li>';
  } else {
    carrito.forEach((item, index) => {
      total += item.precio * (item.cantidad || 1);
      const li = document.createElement('li');
      li.innerHTML = `${item.nombre} x${item.cantidad || 1} - ‚Ç¨${(item.precio*(item.cantidad||1)).toFixed(2)}
        <button onclick="eliminarItem(${index})" style="float:right; background:red; color:#fff; border:none; border-radius:3px; cursor:pointer;">X</button>`;
      lista.appendChild(li);
    });
  }
  document.getElementById('total').textContent = total.toFixed(2);
}

function eliminarItem(index) {
  carrito.splice(index,1);
  localStorage.setItem('carrito', JSON.stringify(carrito));
  actualizarCarrito();
}

function vaciarCarrito(){
  carrito = [];
  localStorage.setItem('carrito', JSON.stringify(carrito));
  actualizarCarrito();
}

// Manejo del checkout
document.getElementById('form-checkout').addEventListener('submit', function(e){
  e.preventDefault();
  if(carrito.length === 0){
    alert('Tu carrito est√° vac√≠o');
    return;
  }
  alert('Gracias por tu compra, '+document.getElementById('nombre').value+'!');
  carrito = [];
  localStorage.setItem('carrito', JSON.stringify(carrito));
  actualizarCarrito();
  this.reset();
});

actualizarCarrito();
// ===== LISTA DE DESEOS MEJORADA =====

let deseos = JSON.parse(localStorage.getItem('deseos')) || [];

function actualizarDeseos() {

  const lista = document.getElementById('lista-deseos');

  lista.innerHTML = '';

  if (deseos.length === 0) {
    lista.innerHTML = '<li>Tu lista est√° vac√≠a ‚ù§Ô∏è</li>';
    return;
  }

  deseos.forEach((item, index) => {

    const li = document.createElement('li');

    li.style.padding = '8px 0';
    li.style.borderBottom = '1px solid #ddd';

    li.innerHTML = `

      <a href="${item.link}"
         style="font-weight:600;color:#00ffae;text-decoration:none">
        ${item.nombre}
      </a>
      - ‚Ç¨${item.precio}

      <br>

      <button onclick="pasarACarrito(${index})"
        style="margin-top:5px;
        background:#0a0;color:#fff;
        border:none;padding:4px 8px;
        border-radius:4px;cursor:pointer">
        üõí A√±adir
      </button>

      <button onclick="eliminarDeseo(${index})"
        style="margin-top:5px;
        background:red;color:#fff;
        border:none;padding:4px 8px;
        border-radius:4px;cursor:pointer">
        ‚ùå
      </button>

    `;

    lista.appendChild(li);

  });

  localStorage.setItem('deseos', JSON.stringify(deseos));
}



// Guardar deseos con link
function agregarADeseos(nombre, precio, link) {

  // evitar duplicados
  if (deseos.some(p => p.link === link)) {
    alert("Ya est√° en deseos ‚ù§Ô∏è");
    return;
  }

  deseos.push({ nombre, precio, link });

  localStorage.setItem('deseos', JSON.stringify(deseos));

  alert(nombre + ' a√±adido a tu lista ‚ù§Ô∏è');

  actualizarDeseos();
}



function eliminarDeseo(index) {

  deseos.splice(index, 1);

  localStorage.setItem('deseos', JSON.stringify(deseos));

  actualizarDeseos();
}



// Pasar deseos ‚Üí carrito
function pasarACarrito(index) {

  const producto = deseos[index];

  carrito.push({
    nombre: producto.nombre,
    precio: producto.precio,
    cantidad: 1,
    link: producto.link
  });

  localStorage.setItem('carrito', JSON.stringify(carrito));

  deseos.splice(index, 1);

  localStorage.setItem('deseos', JSON.stringify(deseos));

  actualizarCarrito();
  actualizarDeseos();

  alert("A√±adido al carrito üõí");
}


document.addEventListener('DOMContentLoaded', actualizarDeseos);

li.innerHTML = `
  <a href="${item.link}"
     style="color:#00ffae;text-decoration:none;font-weight:600">
    ${item.nombre}
  </a>
  x${item.cantidad || 1}
  - ‚Ç¨${(item.precio*(item.cantidad||1)).toFixed(2)}

  <button onclick="eliminarItem(${index})"
    style="float:right; background:red; color:#fff;
    border:none; border-radius:3px; cursor:pointer;">
    X
  </button>
`;




</script>


</body>
</html>
